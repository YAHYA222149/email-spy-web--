<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Email Untracker</title>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-2LNFV1ZJ0Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-2LNFV1ZJ0Q');
  </script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: #e8f1f5;
      color: #333;
    }
    #langSelect {
      position: absolute;
      top: 20px;
      right: 20px;
      padding: 6px 12px;
      border-radius: 8px;
      border: 2px solid #2a607c;
      font-weight: bold;
      cursor: pointer;
      background: white;
      color: #2a607c;
    }
    h1 {
      text-align: center;
      color: #2a607c;
      margin-top: 60px;
    }
    label {
      display: block;
      margin: 10px 0 5px;
      font-weight: bold;
    }
    textarea {
      width: 100%;
      height: 150px;
      padding: 10px;
      border: 1px solid #b0c4d6;
      border-radius: 8px;
      resize: vertical;
      background: #f9fcfe;
      color: #333;
      font-family: monospace;
    }
    button {
      background-color: #2a607c;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 10px;
      transition: background-color 0.3s ease;
      font-weight: bold;
    }
    button:hover {
      background-color: #3b7d99;
    }
    .section {
      background: #ffffff;
      padding: 20px;
      margin-top: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    pre {
      background: #f2f7fa;
      padding: 10px;
      border-radius: 8px;
      overflow-x: auto;
      white-space: pre-wrap;
      font-family: monospace;
    }
  </style>
</head>
<body>

  <select id="langSelect" onchange="setLanguage()" aria-label="Select Language">
    <option value="en">English</option>
    <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
    <option value="fr">FranÃ§ais</option>
    <option value="es">EspaÃ±ol</option>
    <option value="de">Deutsch</option>
  </select>

  <h1 id="title"></h1>

  <div class="section">
    <label id="inputLabel" for="input"></label>
    <textarea id="input" spellcheck="false" autocomplete="off" autocorrect="off" autocapitalize="off" placeholder=""></textarea>
    <button onclick="cleanEmail()" id="cleanButton"></button>
  </div>

  <div class="section">
    <label id="outputLabel" for="output"></label>
    <textarea id="output" readonly></textarea>
  </div>

  <div class="section">
    <label id="removedLabel"></label>
    <pre id="removed"></pre>
  </div>

  <div class="section">
    <label id="adviceLabel"></label>
    <pre id="advice"></pre>
  </div>

<script>
  // Ø§Ù„Ù„ØºØ© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù…ØªØµÙØ­
  let defaultLang = navigator.language.slice(0,2).toLowerCase();
  const supportedLangs = ['en', 'ar', 'fr', 'es', 'de'];
  let currentLang = supportedLangs.includes(defaultLang) ? defaultLang : 'en';

  const translations = {
    en: {
      title: "Email Untracker",
      inputLabel: "ğŸ“Œ Paste your email content or HTML:",
      cleanButton: "Clean",
      outputLabel: "âœ… Clean Result:",
      removedLabel: "âš ï¸ Removed Tracking Elements:",
      adviceLabel: "ğŸ’¡ Suggested Advice:",
      noSpy: "âœ… No tracking elements found.",
      adviceSafe: "âœ… This email appears clean and safe. You can reply normally.",
      adviceLow: "âš ï¸ Contains a small number of tracking elements (likely marketing). You may ignore or unsubscribe, but replying is generally safe.",
      adviceHigh: "âš ï¸ High number of tracking elements detected! It's recommended to avoid replying. Consider deleting or blocking the sender."
    },
    ar: {
      title: "Ù…Ù†Ø¸Ù Ø§Ù„Ø¨Ø±ÙŠØ¯ Ù…Ù† Ø§Ù„ØªØªØ¨Ø¹",
      inputLabel: "ğŸ“Œ Ø§Ù„ØµÙ‚ Ù‡Ù†Ø§ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø£Ùˆ HTML:",
      cleanButton: "ØªÙ†Ø¸ÙŠÙ",
      outputLabel: "âœ… Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ø¸ÙŠÙØ©:",
      removedLabel: "âš ï¸ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ¬Ø³Ø³ÙŠØ© Ø§Ù„ØªÙŠ Ø£Ø²Ù„Ù†Ø§Ù‡Ø§:",
      adviceLabel: "ğŸ’¡ Ø§Ù„Ù†ØµÙŠØ­Ø© Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©:",
      noSpy: "âœ… Ù„Ù… Ù†Ø¹Ø«Ø± Ø¹Ù„Ù‰ Ø¹Ù†Ø§ØµØ± ØªØ¬Ø³Ø³ÙŠØ©.",
      adviceSafe: "âœ… Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ ÙŠØ¨Ø¯Ùˆ Ù†Ø¸ÙŠÙÙ‹Ø§ ÙˆØ¢Ù…Ù†Ù‹Ø§. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø±Ø¯ Ø¹Ù„ÙŠÙ‡ Ø¨Ø´ÙƒÙ„ Ø·Ø¨ÙŠØ¹ÙŠ.",
      adviceLow: "âš ï¸ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ù‚Ù„ÙŠÙ„ Ù…Ù† Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØªØ¨Ø¹ (ØºØ§Ù„Ø¨Ù‹Ø§ Ù„Ø£ØºØ±Ø§Ø¶ ØªØ³ÙˆÙŠÙ‚ÙŠØ©). ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¬Ø§Ù‡Ù„Ù‡ Ø£Ùˆ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØŒ ÙˆØ§Ù„Ø±Ø¯ Ø¹Ù„ÙŠÙ‡ Ø¢Ù…Ù† Ø¨Ø´ÙƒÙ„ Ø¹Ø§Ù….",
      adviceHigh: "âš ï¸ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ ÙƒØ¨ÙŠØ± Ù…Ù† Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØªØ¨Ø¹! ÙŠÙÙØ¶Ù„ Ø¹Ø¯Ù… Ø§Ù„Ø±Ø¯ Ø¹Ù„ÙŠÙ‡ØŒ Ø§Ø­Ø°Ù Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø£Ùˆ Ø§Ø­Ø¸Ø± Ø§Ù„Ù…Ø±Ø³Ù„."
    },
    fr: {
      title: "Nettoyeur d'Email",
      inputLabel: "ğŸ“Œ Collez le contenu ou HTML de votre email :",
      cleanButton: "Nettoyer",
      outputLabel: "âœ… RÃ©sultat NettoyÃ© :",
      removedLabel: "âš ï¸ Ã‰lÃ©ments de Suivi SupprimÃ©s :",
      adviceLabel: "ğŸ’¡ Conseil SuggÃ©rÃ© :",
      noSpy: "âœ… Aucun Ã©lÃ©ment de suivi dÃ©tectÃ©.",
      adviceSafe: "âœ… Cet email semble sÃ»r. Vous pouvez rÃ©pondre normalement.",
      adviceLow: "âš ï¸ Contient quelques Ã©lÃ©ments de suivi (probablement marketing). Vous pouvez ignorer ou vous dÃ©sinscrire.",
      adviceHigh: "âš ï¸ Grand nombre d'Ã©lÃ©ments de suivi dÃ©tectÃ©s ! Il est recommandÃ© de ne pas rÃ©pondre."
    },
    es: {
      title: "Limpiador de Correo",
      inputLabel: "ğŸ“Œ Pega el contenido o HTML del correo:",
      cleanButton: "Limpiar",
      outputLabel: "âœ… Resultado Limpio:",
      removedLabel: "âš ï¸ Elementos de Rastreo Eliminados:",
      adviceLabel: "ğŸ’¡ Consejo Sugerido:",
      noSpy: "âœ… No se encontraron elementos de rastreo.",
      adviceSafe: "âœ… Este correo parece seguro. Puedes responder normalmente.",
      adviceLow: "âš ï¸ Contiene algunos elementos de rastreo (probablemente marketing). Puedes ignorarlo o darte de baja.",
      adviceHigh: "âš ï¸ Â¡Alto nÃºmero de elementos de rastreo detectados! Se recomienda no responder."
    },
    de: {
      title: "Email-Reiniger",
      inputLabel: "ğŸ“Œ FÃ¼gen Sie den Inhalt oder HTML der E-Mail ein:",
      cleanButton: "Reinigen",
      outputLabel: "âœ… Sauberes Ergebnis:",
      removedLabel: "âš ï¸ Entfernte Tracking-Elemente:",
      adviceLabel: "ğŸ’¡ Vorgeschlagener Rat:",
      noSpy: "âœ… Keine Tracking-Elemente gefunden.",
      adviceSafe: "âœ… Diese E-Mail scheint sicher zu sein. Sie kÃ¶nnen normal antworten.",
      adviceLow: "âš ï¸ EnthÃ¤lt einige Tracking-Elemente (wahrscheinlich Marketing). Ignorieren oder abmelden mÃ¶glich.",
      adviceHigh: "âš ï¸ Hohe Anzahl an Tracking-Elementen erkannt! Antwort wird nicht empfohlen."
    }
  };

  // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„ØºØ©
  function initLanguage() {
    const select = document.getElementById('langSelect');
    select.value = currentLang;
    updateTexts();
  }

  function updateTexts() {
    const t = translations[currentLang];
    document.getElementById('title').textContent = t.title;
    document.getElementById('inputLabel').textContent = t.inputLabel;
    document.getElementById('input').placeholder = t.inputLabel;
    document.getElementById('cleanButton').textContent = t.cleanButton;
    document.getElementById('outputLabel').textContent = t.outputLabel;
    document.getElementById('removedLabel').textContent = t.removedLabel;
    document.getElementById('adviceLabel').textContent = t.adviceLabel;
  }

  function setLanguage() {
    const select = document.getElementById('langSelect');
    currentLang = select.value;
    updateTexts();
    if(document.getElementById('input').value.trim()) {
      cleanEmail();
    }
  }

  function cleanEmail() {
    const t = translations[currentLang];
    let html = document.getElementById('input').value;
    let removedItems = [];
    let trackingCount = 0;

    // Ø¥Ø²Ø§Ù„Ø© ØµÙˆØ± Ø§Ù„ØªØ¬Ø³Ø³
    html = html.replace(/<img[^>]*>/gi, (match) => {
      const isSpy = /width=['"]?1['"]?|height=['"]?1['"]?/i.test(match);
      if (isSpy) {
        const srcMatch = match.match(/src=['"]([^'"]+)['"]/i);
        removedItems.push((currentLang === 'ar' ? "ğŸ“¸ ØµÙˆØ±Ø© ØªØ¬Ø³Ø³: " : "ğŸ“¸ Spy Image: ") + (srcMatch ? srcMatch[1] : "[unknown src]"));
        trackingCount++;
        return '';
      }
      return match;
    });

    // Ø¥Ø²Ø§Ù„Ø© Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„ØªØªØ¨Ø¹
    html = html.replace(/(\?[^"'>]*)/g, (match) => {
      let params = match.slice(1).split("&");
      let cleanParams = [];
      params.forEach(p => {
        if (/^(utm_|fbclid|gclid)/i.test(p)) {
          removedItems.push((currentLang === 'ar' ? "ğŸ”— Ù…Ø¹Ù„Ù…Ø© ØªØªØ¨Ø¹ Ù…Ø­Ø°ÙˆÙØ©: " : "ğŸ”— Tracking Param Removed: ") + p);
          trackingCount++;
        } else {
          cleanParams.push(p);
        }
      });
      return cleanParams.length ? "?" + cleanParams.join("&") : "";
    });

    document.getElementById('output').value = html;
    document.getElementById('removed').textContent = removedItems.length ? removedItems.join("\n") : t.noSpy;

    let adviceText = t.adviceSafe;
    if (trackingCount === 0) adviceText = t.adviceSafe;
    else if (trackingCount <= 2) adviceText = t.adviceLow;
    else adviceText = t.adviceHigh;

    document.getElementById('advice').textContent = adviceText;
  }

  // Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ù…Ù„
  initLanguage();
</script>

</body>
</html>
